## Goal
- Reorganize Android app package/directory structure around features to improve maintainability and extensibility.
- Separate shared logic from feature-level UI/domain logic to simplify dependency direction.

## Scope
- Package moves and file organization
- Import path updates
- Reference path checks in Gradle/Manifest
- Refactoring without behavior changes

## Out of Scope
- Feature changes/additions
- UI/UX redesign
- API specification changes

## Recommended Feature-Centered Structure
- `com.rpa.android.core`
  - `CrashReporter`, `CryptoProvider`, `ServiceEvents`, `MetricsStore`
- `com.rpa.android.data`
  - `ConfigStore`, `LogStore`, `KeyStore`, model data classes
- `com.rpa.android.tunnel`
  - `RpaService`, `RpaServiceController`, `SshTunnelManager`, `NetworkMonitor`, `SleepMonitor`, `ErrorClassifier`
- `com.rpa.android.ui`
  - `MainActivity`, shared components
  - keep `ui.theme`
- `com.rpa.android.feature.*`
  - status/logs/config/metrics/doctor components (extract composables currently in `MainActivity`)

## Steps
1. Map current files to responsibilities.
2. Finalize package move plan.
3. Move files and update imports.
4. Validate build/runtime (local `assembleRelease`).

## Risks and Mitigations
- Missing imports/package refs during refactor -> detect immediately via build.
- Resource reference mismatches -> fix based on build failures.

## Completion Criteria
- Build succeeds.
- App behavior remains unchanged (minimum check: launch/logs/SSH connection/Doctor tab).

## Internal Component Structure (Mermaid)

```mermaid
flowchart TB
  subgraph Core
    Crash[CrashReporter]
    Crypto[CryptoProvider]
    Events[ServiceEvents]
    Metrics[MetricsStore]
  end

  subgraph Data
    Config[ConfigStore]
    Logs[LogStore]
    Keys[KeyStore]
  end

  subgraph Tunnel
    Service[RpaService]
    Controller[RpaServiceController]
    Manager[SshTunnelManager]
    Net[NetworkMonitor]
    Sleep[SleepMonitor]
    Err[ErrorClassifier]
  end

  subgraph UI
    Main[MainActivity]
    Features[feature/status|logs|config|metrics|doctor]
    Theme[ui.theme]
  end

  UI --> Tunnel
  Tunnel --> Data
  Tunnel --> Core
  UI --> Core
```
